{% extends 'base.html' %}

{% block header_image2 %} /static/header9.png{% endblock %}

{% block content %}
    

    <!-- <form action="/trimAndMerge" method="post" id="videoForm"> -->
    <form method="post" id="videoForm">
        <div class="title-div">
            <h1 class="page-title">{% block title %}Clip & Merge{% endblock %}</h1>
        </div>
        <!-- Scrolling Info Banner -->
        <div class="scrolling-banner">
            <div class="scrolling-text" id="scrollingText">
                üéß This website gives an easy way to create an audio file by combining clips from one or more YouTube video URLs. 
            </div>
            <!-- Pause/Unpause button. Make sure it doesn't submit the form -->
            <button id="pauseBtn" class="pause-btn" type="button" aria-pressed="false" title="Pause scrolling">‚è∏</button>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const scrollingText = document.getElementById("scrollingText");
                const pauseBtn = document.getElementById("pauseBtn");
                let isPaused = false;

                pauseBtn.addEventListener("click", (e) => {
                    // Prevent click from bubbling in case parent handlers exist
                    e.stopPropagation();

                    isPaused = !isPaused;
                    scrollingText.style.animationPlayState = isPaused ? "paused" : "running";
                    pauseBtn.textContent = isPaused ? "‚ñ∂Ô∏è" : "‚è∏";
                    pauseBtn.setAttribute("aria-pressed", String(isPaused));
                    pauseBtn.classList.toggle('paused', isPaused);
                });

                // Also pause on hover
                document.querySelector('.scrolling-banner').addEventListener('mouseenter', () => {
                    if (!isPaused) scrollingText.style.animationPlayState = 'paused';
                });
                document.querySelector('.scrolling-banner').addEventListener('mouseleave', () => {
                    if (!isPaused) scrollingText.style.animationPlayState = 'running';
                });
            });
        </script>
        <div class="urlDiv1" id="urlDivTemplate">
            <table style="width: 100%;">
                <tr>
                    <td style="text-align: right; vertical-align: middle; padding: 2px;">
                        <label style="color: white;"><i class="fab fa-youtube text-red-600 text-2xl"></i> YouTube URL:</label>&nbsp;
                        <i class="fas fa-question-circle text-blue-400 cursor-pointer" 
                            onclick="openHelpModal('urlHelp')"></i>
                    </td>
                    <td>
                        <input type="text" id="url" class="inputURL" placeholder="https://www.youtube.com/watch?v=..." required>
                    </td>
                </tr>
                <tr >
                    <td style="text-align: right; color: white; padding: 5px;">
                        <label>Start Time:</label>&nbsp;
                        <i class="fas fa-question-circle text-blue-400 cursor-pointer" 
                            onclick="openHelpModal('startHelp')"></i>
                    </td>
                    <td >
                        <input type="text" id="start" placeholder="HH:MM:SS.mmm" class="inputTime" required>
                    </td>
                </tr>
                <tr >
                    <td style="text-align: right; color: white; padding: 5px;">
                        <label>End Time:</label>&nbsp;
                        <i class="fas fa-question-circle text-blue-400 cursor-pointer" 
                            onclick="openHelpModal('endHelp')"></i>
                    </td>
                    <td >
                        <input type="text" id="end" placeholder="HH:MM:SS.mmm" class="inputTime" required>
                </tr>
            </table>
            <!-- User Responsibility Confirmation -->
            <div class="copyright-confirmation">
                <label>
                    <input type="checkbox" id="copyrightConfirm" required>
                    I confirm that I own or have permission to use the videos I submit.
                </label>
            </div>

            <div id="addBtnWrapper">
                <button id= "addClipButton" type="submit" class="add-btn" >‚ûï Add Clip</button>
            </div>
        </div>
    </form>
        <br>

        <!-- Videos Carousel -->
        <div id="videosContainer" class="mb-8">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-gray-900 text-white">Your Videos</h2>
                <button id="submitAllBtn" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-medium transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>
                    <i class="fas fa-music mr-2"></i>Clip & Merge All
                </button>
                <div class="flex items-center space-x-2 text-sm text-gray-600 text-white">
                    <span id="videoCount">0 videos</span>
                </div>
            </div>

            <div id="noVideosMessage" class="text-center py-12 bg-white rounded-lg shadow-sm">
                <i class="fas fa-film text-gray-400 text-4xl mb-4"></i>
                <p class="text-gray-500">No videos added yet. Add your first video above.</p>
            </div>

            <div id="carouselWrapper" class="hidden relative">
                <div class="carousel-container flex overflow-x-auto space-x-6 pb-4 scrollbar-hide" id="carousel">
                    <!-- Video cards will be dynamically added here -->
                </div>

                <!-- Navigation Buttons -->
                <button id="prevBtn" class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 bg-white shadow-lg rounded-full w-10 h-10 flex items-center justify-center hover:bg-gray-50 transition-colors">
                    <i class="fas fa-chevron-left text-gray-700"></i>
                </button>
                <button id="nextBtn" class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 bg-white shadow-lg rounded-full w-10 h-10 flex items-center justify-center hover:bg-gray-50 transition-colors">
                    <i class="fas fa-chevron-right text-gray-700"></i>
                </button>
            </div>
        </div>

        <br>
        <!-- <div class="form-group">
            <input type="submit" value="Trim & Merge" class="btn btn-primary">
            <button id="submitAllBtn" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-medium transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>
                    <i class="fas fa-music mr-2"></i>Clip & Merge All
            </button>
        </div> -->
        
         <!-- Loader overlay -->
        <div id="overlay">
            <div class="spinner"></div>
            <p style="color:white; margin-top:10px;">Please wait...</p>
        </div>

        <!-- Help Modal -->
        <div id="helpModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg shadow-lg p-6 w-96 relative">
                <h2 id="helpTitle" class="text-xl font-semibold mb-2 text-gray-800"></h2>
                <p id="helpContent" class="text-gray-700" style="justify-content: left; justify-items: left;"></p>

                <button onclick="closeHelpModal()" 
                        class="absolute top-2 right-3 text-gray-500 hover:text-gray-800">
                <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

    
    <script src="{{ url_for('static', filename= 'carousel-scripts.js') }}"> </script>

{% endblock %}